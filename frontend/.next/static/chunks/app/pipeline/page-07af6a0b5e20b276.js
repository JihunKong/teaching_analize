(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[80],{8072:function(e,a,t){Promise.resolve().then(t.bind(t,805))},805:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return c}});var r=t(7437),s=t(2265),o=t(9376),n=t(29),i=t.n(n);function l(e){let{workflowId:a,onComplete:t}=e,[o,n]=(0,s.useState)([{id:"transcription",name:"영상 전사",status:"pending"},{id:"analysis",name:"AI 분석",status:"pending"},{id:"report",name:"보고서 생성",status:"pending"}]),l=(0,s.useRef)(null);return(0,s.useEffect)(()=>{if(!a)return;let e=Date.now(),r=0,s=async()=>{let s=Date.now()-e;if(r++,s>6e5){console.error("Polling timeout after ".concat(Math.floor(s/1e3),"s (").concat(r," attempts)")),l.current&&(clearInterval(l.current),l.current=null),n(e=>{let a=e.find(e=>"in_progress"===e.status);return a?e.map(e=>e.id===a.id?{...e,status:"error",message:"작업 시간 초과 (10분). 페이지를 새로고침하거나 다시 시도해주세요."}:e):e});return}try{let e=window.location.origin,r=await fetch("".concat(e,"/api/workflow/status/").concat(a)),s=await r.json();if(console.log("Workflow status:",s),"success"===s.status||"completed"===s.current_step){console.log("Workflow completed! Stopping polling."),n(e=>e.map(e=>({...e,status:"completed"}))),l.current&&(clearInterval(l.current),l.current=null),t&&t(s.data);return}if("error"===s.status||"failed"===s.status){console.log("Workflow failed. Stopping polling."),l.current&&(clearInterval(l.current),l.current=null),n(e=>{let a=e.findIndex(e=>e.id===s.current_step);if(a>=0){let t=[...e];return t[a]={...t[a],status:"error",message:s.message||"작업 중 오류가 발생했습니다"},t}return e});return}s.current_step&&n(e=>e.map(e=>{var a;return e.id===s.current_step?{...e,status:"in_progress",message:s.message}:(null===(a=s.completed_steps)||void 0===a?void 0:a.includes(e.id))?{...e,status:"completed"}:e}))}catch(e){console.error("Failed to fetch workflow status:",e)}};return l.current=setInterval(s,3e3),s(),()=>{l.current&&(clearInterval(l.current),l.current=null)}},[a,t]),(0,r.jsxs)("div",{style:{padding:"var(--space-6)",marginBottom:"var(--space-8)"},className:"jsx-4bef2a77caafd59e glass-card",children:[(0,r.jsxs)("div",{style:{marginBottom:"var(--space-6)",textAlign:"center"},className:"jsx-4bef2a77caafd59e",children:[(0,r.jsx)("h2",{style:{fontSize:"var(--text-2xl)",fontWeight:"700",marginBottom:"var(--space-2)",background:"linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-dark) 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},className:"jsx-4bef2a77caafd59e",children:"분석 진행 중"}),(0,r.jsx)("p",{style:{fontSize:"var(--text-sm)",color:"var(--color-text-secondary)"},className:"jsx-4bef2a77caafd59e",children:"AI가 수업 영상을 정밀하게 분석하고 있습니다"})]}),(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",position:"relative",marginBottom:"var(--space-8)",maxWidth:"800px",margin:"0 auto var(--space-8)"},className:"jsx-4bef2a77caafd59e",children:[(0,r.jsx)("div",{style:{position:"absolute",top:"24px",left:"0",right:"0",height:"4px",background:"var(--color-surface-alt)",borderRadius:"var(--radius-full)",zIndex:0},className:"jsx-4bef2a77caafd59e"}),(0,r.jsx)("div",{style:{position:"absolute",top:"24px",left:"0",height:"4px",background:"linear-gradient(90deg, var(--color-primary) 0%, var(--color-secondary) 100%)",borderRadius:"var(--radius-full)",zIndex:0,width:"".concat(o.filter(e=>"completed"===e.status).length/(o.length-1)*100,"%"),transition:"width 0.5s ease-in-out"},className:"jsx-4bef2a77caafd59e"}),o.map((e,a)=>(0,r.jsxs)("div",{style:{position:"relative",zIndex:1,display:"flex",flexDirection:"column",alignItems:"center",width:"120px"},className:"jsx-4bef2a77caafd59e",children:[(0,r.jsx)("div",{style:{width:"48px",height:"48px",borderRadius:"50%",background:"completed"===e.status?"var(--color-secondary)":"in_progress"===e.status?"var(--color-primary)":"error"===e.status?"var(--color-danger)":"var(--color-surface)",border:"pending"===e.status?"2px solid var(--color-surface-alt)":"none",display:"flex",alignItems:"center",justifyContent:"center",color:"pending"===e.status?"var(--color-text-tertiary)":"white",boxShadow:"in_progress"===e.status?"0 0 0 4px rgba(79, 70, 229, 0.2)":"var(--shadow-sm)",transition:"all 0.3s ease",marginBottom:"var(--space-3)"},className:"jsx-4bef2a77caafd59e",children:"completed"===e.status?(0,r.jsx)("svg",{width:"24",height:"24",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"jsx-4bef2a77caafd59e",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M5 13l4 4L19 7",className:"jsx-4bef2a77caafd59e"})}):"in_progress"===e.status?(0,r.jsx)("div",{style:{width:"24px",height:"24px",border:"3px solid rgba(255,255,255,0.3)",borderTopColor:"white",borderRadius:"50%"},className:"jsx-4bef2a77caafd59e animate-spin"}):"error"===e.status?(0,r.jsx)("svg",{width:"24",height:"24",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"jsx-4bef2a77caafd59e",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12",className:"jsx-4bef2a77caafd59e"})}):(0,r.jsx)("span",{style:{fontWeight:"600"},className:"jsx-4bef2a77caafd59e",children:a+1})}),(0,r.jsx)("div",{style:{fontSize:"var(--text-sm)",fontWeight:"in_progress"===e.status?"600":"500",color:"pending"===e.status?"var(--color-text-tertiary)":"var(--color-text-primary)",textAlign:"center"},className:"jsx-4bef2a77caafd59e",children:e.name}),"in_progress"===e.status&&e.message&&(0,r.jsx)("div",{style:{position:"absolute",top:"80px",width:"200px",textAlign:"center",fontSize:"var(--text-xs)",color:"var(--color-primary)",background:"rgba(79, 70, 229, 0.1)",padding:"4px 8px",borderRadius:"var(--radius-full)",animation:"fadeIn 0.3s ease"},className:"jsx-4bef2a77caafd59e",children:e.message})]},e.id))]}),(0,r.jsx)("div",{style:{textAlign:"center",paddingTop:"var(--space-6)",borderTop:"1px solid var(--color-surface-alt)"},className:"jsx-4bef2a77caafd59e",children:(0,r.jsxs)("div",{style:{fontSize:"var(--text-sm)",color:"var(--color-text-secondary)",display:"flex",alignItems:"center",justifyContent:"center",gap:"var(--space-2)"},className:"jsx-4bef2a77caafd59e",children:[(0,r.jsx)("svg",{width:"16",height:"16",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"jsx-4bef2a77caafd59e",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z",className:"jsx-4bef2a77caafd59e"})}),(0,r.jsx)("span",{className:"jsx-4bef2a77caafd59e",children:"예상 소요 시간: 3-5분"})]})}),(0,r.jsx)(i(),{id:"4bef2a77caafd59e",children:"@-webkit-keyframes spin{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes spin{to{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes spin{to{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{to{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}.animate-spin.jsx-4bef2a77caafd59e{-webkit-animation:spin 1s linear infinite;-moz-animation:spin 1s linear infinite;-o-animation:spin 1s linear infinite;animation:spin 1s linear infinite}"})]})}function c(){(0,o.useRouter)();let[e,a]=(0,s.useState)(""),[t,n]=(0,s.useState)("cbil_comprehensive"),[i,c]=(0,s.useState)(null),[d,p]=(0,s.useState)(!1),[u,m]=(0,s.useState)(null),x=async a=>{a.preventDefault(),m(null),p(!0);try{let a=window.location.origin,r=await fetch("".concat(a,"/api/workflow/full-analysis"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({video_url:e,framework:t,language:"ko",use_diarization:!0})});if(!r.ok)throw Error("Failed to start workflow");let s=await r.json();c(s.workflow_id)}catch(e){m(e instanceof Error?e.message:"An error occurred"),p(!1)}};return(0,r.jsx)("div",{style:{minHeight:"100vh",background:"radial-gradient(circle at 50% 0%, rgba(37, 99, 235, 0.1) 0%, transparent 50%)",padding:"var(--space-8) var(--space-4)"},children:(0,r.jsxs)("div",{className:"container",style:{maxWidth:"800px"},children:[(0,r.jsxs)("div",{className:"text-center animate-fade-in",style:{marginBottom:"var(--space-8)"},children:[(0,r.jsx)("h1",{style:{fontSize:"var(--text-4xl)",fontWeight:"800",marginBottom:"var(--space-4)",background:"linear-gradient(135deg, var(--color-primary) 0%, var(--color-secondary) 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"Start New Analysis"}),(0,r.jsx)("p",{style:{fontSize:"var(--text-lg)",color:"var(--color-text-secondary)",maxWidth:"600px",margin:"0 auto"},children:"Enter your YouTube video URL below to generate a comprehensive educational analysis report."})]}),i?(0,r.jsx)("div",{className:"animate-fade-in",children:(0,r.jsx)(l,{workflowId:i,onComplete:e=>{console.log("handleComplete called with data:",e);let a=(null==e?void 0:e.analysis_id)||(null==e?void 0:e.analysis_job_id);a?(console.log("Redirecting directly to HTML report:",a),window.location.href="/api/reports/html/".concat(a)):(console.error("No analysis_id found in completion data:",e),m("보고서 ID를 찾을 수 없습니다. 관리자에게 문의하세요."))}})}):(0,r.jsx)("div",{className:"glass-card animate-fade-in",style:{padding:"var(--space-8)"},children:(0,r.jsxs)("form",{onSubmit:x,children:[(0,r.jsxs)("div",{style:{marginBottom:"var(--space-6)"},children:[(0,r.jsx)("label",{htmlFor:"videoUrl",style:{display:"block",fontSize:"var(--text-sm)",fontWeight:"600",color:"var(--color-text-primary)",marginBottom:"var(--space-2)",marginLeft:"var(--space-1)"},children:"YouTube Video URL"}),(0,r.jsxs)("div",{style:{position:"relative"},children:[(0,r.jsx)("input",{id:"videoUrl",type:"url",required:!0,value:e,onChange:e=>a(e.target.value),placeholder:"https://www.youtube.com/watch?v=...",style:{width:"100%",padding:"var(--space-4)",paddingLeft:"var(--space-12)",borderRadius:"var(--radius-xl)",border:"1px solid var(--color-border)",background:"rgba(255, 255, 255, 0.5)",fontSize:"var(--text-base)",color:"var(--color-text-primary)",outline:"none",transition:"all 0.2s ease"},className:"focus:ring-2 focus:ring-primary"}),(0,r.jsx)("div",{style:{position:"absolute",left:"var(--space-4)",top:"50%",transform:"translateY(-50%)",fontSize:"var(--text-xl)"},children:"\uD83D\uDCF9"})]})]}),(0,r.jsxs)("div",{style:{marginBottom:"var(--space-8)"},children:[(0,r.jsx)("label",{htmlFor:"framework",style:{display:"block",fontSize:"var(--text-sm)",fontWeight:"600",color:"var(--color-text-primary)",marginBottom:"var(--space-2)",marginLeft:"var(--space-1)"},children:"Analysis Framework"}),(0,r.jsxs)("div",{style:{position:"relative"},children:[(0,r.jsxs)("select",{id:"framework",value:t,onChange:e=>n(e.target.value),style:{width:"100%",padding:"var(--space-4)",paddingLeft:"var(--space-12)",borderRadius:"var(--radius-xl)",border:"1px solid var(--color-border)",background:"rgba(255, 255, 255, 0.5)",fontSize:"var(--text-base)",color:"var(--color-text-primary)",outline:"none",cursor:"pointer",appearance:"none"},children:[(0,r.jsx)("option",{value:"cbil_comprehensive",children:"CBIL Comprehensive Analysis"}),(0,r.jsx)("option",{value:"diagnostic",children:"Diagnostic Report"}),(0,r.jsx)("option",{value:"bloom",children:"Bloom's Taxonomy"}),(0,r.jsx)("option",{value:"webb",children:"Webb's DOK"})]}),(0,r.jsx)("div",{style:{position:"absolute",left:"var(--space-4)",top:"50%",transform:"translateY(-50%)",fontSize:"var(--text-xl)"},children:"\uD83E\uDDE0"}),(0,r.jsx)("div",{style:{position:"absolute",right:"var(--space-4)",top:"50%",transform:"translateY(-50%)",pointerEvents:"none",color:"var(--color-text-secondary)"},children:"▼"})]})]}),u&&(0,r.jsxs)("div",{style:{padding:"var(--space-4)",marginBottom:"var(--space-6)",background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.2)",borderRadius:"var(--radius-lg)",color:"#ef4444",fontSize:"var(--text-sm)",display:"flex",alignItems:"center",gap:"var(--space-3)"},children:[(0,r.jsx)("span",{children:"⚠️"}),u]}),(0,r.jsx)("button",{type:"submit",disabled:d,className:"btn btn-primary btn-large",style:{width:"100%",justifyContent:"center",opacity:d?.7:1},children:d?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"animate-spin",style:{marginRight:"var(--space-2)"},children:"⚪"}),"Starting Analysis..."]}):(0,r.jsxs)(r.Fragment,{children:["Start Analysis ",(0,r.jsx)("span",{style:{marginLeft:"var(--space-2)"},children:"→"})]})})]})}),(0,r.jsxs)("div",{className:"grid grid-3",style:{marginTop:"var(--space-12)",gap:"var(--space-6)"},children:[(0,r.jsxs)("div",{className:"glass-card",style:{padding:"var(--space-6)",textAlign:"center"},children:[(0,r.jsx)("div",{style:{fontSize:"var(--text-3xl)",marginBottom:"var(--space-3)"},children:"⚡️"}),(0,r.jsx)("h3",{style:{fontSize:"var(--text-lg)",fontWeight:"700",marginBottom:"var(--space-2)"},children:"Fast"}),(0,r.jsx)("p",{style:{fontSize:"var(--text-sm)",color:"var(--color-text-secondary)"},children:"Automated transcription and analysis in minutes."})]}),(0,r.jsxs)("div",{className:"glass-card",style:{padding:"var(--space-6)",textAlign:"center"},children:[(0,r.jsx)("div",{style:{fontSize:"var(--text-3xl)",marginBottom:"var(--space-3)"},children:"\uD83C\uDFAF"}),(0,r.jsx)("h3",{style:{fontSize:"var(--text-lg)",fontWeight:"700",marginBottom:"var(--space-2)"},children:"Accurate"}),(0,r.jsx)("p",{style:{fontSize:"var(--text-sm)",color:"var(--color-text-secondary)"},children:"Powered by advanced AI models for deep insights."})]}),(0,r.jsxs)("div",{className:"glass-card",style:{padding:"var(--space-6)",textAlign:"center"},children:[(0,r.jsx)("div",{style:{fontSize:"var(--text-3xl)",marginBottom:"var(--space-3)"},children:"\uD83D\uDCCA"}),(0,r.jsx)("h3",{style:{fontSize:"var(--text-lg)",fontWeight:"700",marginBottom:"var(--space-2)"},children:"Visual"}),(0,r.jsx)("p",{style:{fontSize:"var(--text-sm)",color:"var(--color-text-secondary)"},children:"Clear, interactive charts and actionable reports."})]})]})]})})}}},function(e){e.O(0,[847,971,117,744],function(){return e(e.s=8072)}),_N_E=e.O()}]);