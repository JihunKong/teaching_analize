#!/usr/bin/env ts-node

/**
 * AIBOA Platform - Generate Final Validation Report
 * Standalone script to generate comprehensive validation report
 */

import { FinalValidationReporter } from './tests/utils/final-validation-reporter';

async function main() {
  console.log('üöÄ AIBOA Platform - Final Validation Report Generator');
  console.log('================================================\n');

  const resultsDir = process.argv[2] || 'test-results';
  
  console.log(`üìÇ Using results directory: ${resultsDir}`);
  
  const reporter = new FinalValidationReporter(resultsDir);
  
  try {
    const validationResults = await reporter.generateFinalValidationReport();
    
    console.log('\nüìä Final Validation Results:');
    console.log('============================');
    console.log(`Overall Score: ${validationResults.overallScore}%`);
    console.log(`Grade: ${validationResults.grade}`);
    console.log(`Production Ready: ${validationResults.productionReadiness ? 'Yes' : 'No'}`);
    console.log(`Functionality Complete: ${validationResults.functionalityComplete ? 'Yes' : 'No'}`);
    console.log(`Recovery Ready: ${validationResults.recoveryReadiness ? 'Yes' : 'No'}`);
    
    console.log('\nüí° Key Recommendations:');
    validationResults.recommendations.forEach((rec, index) => {
      console.log(`${index + 1}. ${rec}`);
    });
    
    console.log('\n‚úÖ Final validation report generated successfully!');
    console.log('üìÑ Check the following files:');
    console.log(`   - ${resultsDir}/final-validation-report.json`);
    console.log(`   - ${resultsDir}/final-validation-report.html`);
    console.log(`   - ${resultsDir}/FINAL_VALIDATION_SUMMARY.md`);
    
    // Exit with appropriate code based on results
    if (validationResults.productionReadiness) {
      process.exit(0);
    } else if (validationResults.overallScore >= 70) {
      process.exit(1); // Minor issues
    } else {
      process.exit(2); // Critical issues
    }
    
  } catch (error) {
    console.error('‚ùå Error generating final validation report:', error);
    process.exit(3);
  }
}

if (require.main === module) {
  main();
}